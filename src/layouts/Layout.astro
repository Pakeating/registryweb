---
import Navbar from '../components/Navbar.astro';

// Define the manifest object here to be embedded in the page.
// This avoids a network request that is being blocked by the development environment's auth.
const manifest = {
  name: 'Registro de Comidas',
  short_name: 'Comidas',
  description: 'Una app para registrar comidas y enviarlas a Notion.',
  start_url: '/',
  display: 'standalone',
  scope: '/',
  theme_color: '#F5F5F4',
  background_color: '#F5F5F4',
  icons: [
    {
      src: '/icons/icon-192x192.svg',
      sizes: '192x192',
      type: 'image/svg+xml'
    },
    {
      src: '/icons/icon-512x512.svg',
      sizes: '512x512',
      type: 'image/svg+xml',
      purpose: 'any maskable'
    }
  ]
};
---
<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		<title>RegistryWeb</title>
    {/* Embed the manifest as a data URI to avoid auth interception */}
    <link rel="manifest" href={`data:application/manifest+json,${JSON.stringify(manifest)}`} />
    {/* Add theme-color meta tag for Safari compatibility */}
    <meta name="theme-color" content={manifest.theme_color} />
    <style is:global>
        @import '../styles/global.css';
    </style>
	</head>
	<body>
    <Navbar />
		<slot />
    <script>
        // This script registers the service worker generated by vite-plugin-pwa
        import { registerSW } from 'virtual:pwa-register';
        registerSW({
            onOfflineReady() {
                console.log("La aplicación está lista para funcionar sin conexión.");
            },
        });
    </script>
	</body>
</html>

<style>
	html,
	body {
		margin: 0;
		width: 100%;
		height: 100%;
        background-color: #F5F5F4; /* stone-100 */
        font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
	}
</style>
